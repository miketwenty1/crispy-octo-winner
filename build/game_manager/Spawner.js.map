{"version":3,"sources":["../../src/game_manager/Spawner.js"],"names":["getRandomBonusValues","bonusValues","Math","floor","random","length","Spawner","config","spawnLocations","addObject","deleteObject","moveObjects","id","spawnInterval","limit","objectType","spawnerType","objectsCreated","start","interval","setInterval","spawnObject","SpawnerType","MONSTER","moveMonsters","CHEST","spawnChest","spawnMonster","ITEM","spawnItem","location","randomItem","itemData","items","item","ItemModel","name","frame","push","pickRandomLocation","chest","ChestModel","monsterNum","attack","health","mVelocity","Movement","monster","MonsterModel","Intervals","ResetLocation","who","num","invalidLocation","some","obj","x","y","console","log","filter","moveMonsterInterval","forEach","move"],"mappings":"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","sourcesContent":["import {\n  SpawnerType,\n  randomNumber,\n  Intervals,\n  Movement,\n} from './utils';\nimport ChestModel from '../models/ChestModel';\nimport MonsterModel from '../models/MonsterModel';\nimport ItemModel from '../models/ItemModel';\nimport * as itemData from '../../public/assets/level/tools.json';\n\nfunction getRandomBonusValues() {\n  // fibonacci sequence\n  const bonusValues = [0, 1, 1, 2, 3, 5, 8, 13, 21];\n  return bonusValues[Math.floor(Math.random() * bonusValues.length)];\n}\nexport default class Spawner {\n  constructor(config, spawnLocations, addObject, deleteObject, moveObjects) {\n    this.id = config.id;\n    this.spawnInterval = config.spawnInterval;\n    this.limit = config.limit;\n    this.objectType = config.spawnerType;\n    this.spawnLocations = spawnLocations;\n    this.addObject = addObject;\n    this.deleteObject = deleteObject;\n    this.objectsCreated = [];\n    this.start();\n    this.moveObjects = moveObjects;\n  }\n\n  start() {\n    this.interval = setInterval(() => {\n      if (this.objectsCreated.length < this.limit) {\n        this.spawnObject();\n      }\n    }, this.spawnInterval);\n    if (this.objectType === SpawnerType.MONSTER) {\n      this.moveMonsters();\n    }\n  }\n\n  spawnObject() {\n    if (this.objectType === SpawnerType.CHEST) {\n      this.spawnChest();\n    } else if (this.objectType === SpawnerType.MONSTER) {\n      this.spawnMonster();\n    } else if (this.objectType === SpawnerType.ITEM) {\n      this.spawnItem();\n    }\n  }\n\n  spawnItem() {\n    // const location = this.pickRandomLocation();\n    const location = [170, 240];\n    const randomItem = itemData.items[Math.floor(Math.random() * itemData.items.length)];\n    const item = new ItemModel(\n      location[0],\n      location[1],\n      this.id,\n      randomItem.name,\n      randomItem.frame,\n      getRandomBonusValues(),\n      getRandomBonusValues(),\n      getRandomBonusValues(),\n    );\n    this.objectsCreated.push(item);\n    this.addObject(item.id, item);\n  }\n\n  spawnChest() {\n    const location = this.pickRandomLocation('chest', 1);\n    const chest = new ChestModel(location[0], location[1], randomNumber(1, 21), this.id);\n    this.objectsCreated.push(chest);\n    this.addObject(chest.id, chest);\n  }\n\n  spawnMonster() {\n    const monsterNum = randomNumber(0, 20);\n    const attack = (monsterNum + 1) * 2;\n    const health = (monsterNum + 1) * 4;\n    const mVelocity = Movement.MONSTER;\n    const location = this.pickRandomLocation('monster', 1);\n    const monster = new MonsterModel(\n      location[0],\n      location[1],\n      randomNumber(21, 21 + attack + health), // coins drop more powerful more likely to drop coins\n      this.id,\n      monsterNum,\n      health,\n      attack,\n      mVelocity,\n      Intervals.Movement.MONSTER,\n      Intervals.ResetLocation.MONSTER,\n    );\n    this.objectsCreated.push(monster);\n    this.addObject(monster.id, monster);\n  }\n\n  pickRandomLocation(who, num) {\n    const location = this.spawnLocations[Math.floor(Math.random() * this.spawnLocations.length)];\n    // some used in an interesting way here\n    const invalidLocation = this.objectsCreated.some((obj) => {\n      if (obj.x === location[0] && obj.y === location[1]) {\n        return true;\n      }\n      return false;\n    });\n    if (invalidLocation) {\n      console.log(`location from ${who} with num: ${num}`);\n      return this.pickRandomLocation(who, num + 1);\n    }\n    return location;\n  }\n\n  removeObject(id) {\n    // filter will return the objects inside our current array that meets\n    // the true value that we specified in the call back\n    // we want to get back the id's minus the one we passed in\n    this.objectsCreated = this.objectsCreated.filter((obj) => obj.id !== id);\n    this.deleteObject(id);\n  }\n\n  moveMonsters() {\n    this.moveMonsterInterval = setInterval(() => {\n      this.objectsCreated.forEach((monster) => {\n        monster.move();\n      });\n      this.moveObjects();\n    }, Intervals.Movement.MONSTER);\n  }\n}\n"],"file":"Spawner.js"}